(function(){
  const $ = s => document.querySelector(s);
  let lang = 'es';
  try {
    const saved = localStorage.getItem('lt_lang');
    if(saved) lang = saved;
  } catch(e){}

  function setLang(lang) {
    document.querySelectorAll('[data-en]').forEach(el => {
      const en = el.getAttribute('data-en');
      const es = el.getAttribute('data-es');
      if(lang === 'en' && en != null) el.textContent = en;
      else if(lang === 'es' && es != null) el.textContent = es;
    });
    const btn = $('#lang-toggle');
    if(btn) btn.textContent = (lang === 'en' ? 'ES | EN' : 'EN | ES');
    try { localStorage.setItem('lt_lang', lang); } catch(e){}
  }

  document.addEventListener('DOMContentLoaded', ()=>{
    setLang(lang);

    // === Selección de elementos ===
    const hb = document.querySelector('.hamburgerv2');
    const menu = document.querySelector('.menu');
    const langBtn = document.querySelector('#lang-toggle');

    // === Funciones del menú hamburguesa ===
    function openMenu(){
      menu.classList.add('open');
      hb.classList.add('active');
      document.body.style.overflow = 'hidden';
    }
    function closeMenu(){
      menu.classList.remove('open');
      hb.classList.remove('active');
      document.body.style.overflow = '';
    }

    // === Eventos del botón hamburguesa ===
    if(hb){
      hb.addEventListener('click', (e)=>{
        e.stopPropagation();
        if(menu.classList.contains('open')) closeMenu();
        else openMenu();
      });
    }

    // Cerrar menú al hacer clic en enlaces
    if(menu){
      menu.querySelectorAll('a').forEach(a=>{
        a.addEventListener('click', closeMenu);
      });
    }

    // Cerrar menú con tecla Escape
    document.addEventListener('keydown', (e)=>{
      if(e.key === 'Escape') closeMenu();
    });

    // Botón de idioma
    if(langBtn){
      langBtn.addEventListener('click', ()=>{
        setLang(lang === 'es' ? 'en' : 'es');
      });
    }

    // === Ocultar intro después de 1.2s ===
    const intro = document.querySelector('.intro');
    if(intro){
      setTimeout(()=>{
        intro.classList.add('hidden');
        setTimeout(()=>{ try{ intro.remove(); }catch(e){} }, 800);
      }, 1200);
    }
  });
})();

